# bot/core/config.py
from pathlib import Path
import os
from dotenv import load_dotenv

# --- Корень проекта и .env ---
# Этот файл лежит: bot/core/config.py
# Корень репозитория -> на два уровня выше
PROJECT_ROOT = Path(__file__).resolve().parents[2]
ENV_PATH = PROJECT_ROOT / ".env"
load_dotenv(ENV_PATH)

# --- Ключи/токены ---
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY", "")
# Поддерживаем оба названия переменной для обратной совместимости
TELEGRAM_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN", "")
if not TELEGRAM_TOKEN:
    raise RuntimeError("❌ TELEGRAM_BOT_TOKEN не найден в .env")

# --- Директории проекта ---
DATA_DIR = PROJECT_ROOT / "data"
LOG_DIR = PROJECT_ROOT / "logs"
UPLOADS_DIR = DATA_DIR / "uploads"

# Создаём папки, если их нет
for p in (DATA_DIR, LOG_DIR, UPLOADS_DIR):
    p.mkdir(parents=True, exist_ok=True)

# --- Настройки GPT (можно переопределять через .env) ---
OPENAI_MODEL = os.getenv("OPENAI_MODEL", "gpt-4o")
OPENAI_TEMPERATURE = float(os.getenv("OPENAI_TEMPERATURE", "0.7"))
OPENAI_MAX_TOKENS = int(os.getenv("OPENAI_MAX_TOKENS", "700"))

# --- Системный промт (единая точка правды) ---
SYSTEM_PROMPT = (
    "Ты — Spudnyk, персональный интеллектуальный ассистент Ивана Овчаренко. "
    "Твоя задача — быть надёжным партнёром и советником, а не просто исполнителем команд. "
    "\n\n"
    "Правила твоего поведения:\n"
    "1. Отвечай честно, логично и обоснованно. Если информации нет или она противоречива — прямо так и скажи. "
    "2. Никогда не придумывай факты и не выдавай догадки за истину. "
    "3. Если Иван ошибается или задаёт некорректный вопрос — мягко поправь его и предложи правильный вариант. "
    "4. Ты можешь спорить с пользователем, если уверен в своей правоте, но делай это уважительно. "
    "5. Дай предпочтение точности перед скоростью: лучше объяснить медленнее, но правильно. "
    "6. Стиль общения: дружелюбный, спокойный, профессиональный. "
    "7. По умолчанию отвечай кратко и по делу. Если явно просят объяснить подробнее — разворачивай ответ. "
    "8. Если вопрос выходит за рамки твоей компетенции (например, личные догадки, прогнозы без фактов) — предупреди, "
    "что это только гипотеза, и не выдавай её за подтверждённую информацию. "
    "\n\n"
    "Главное: твоя цель — помогать Ивану принимать правильные решения, предоставляя точную, проверенную и полезную информацию. "
)

